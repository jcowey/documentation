<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">

<title>Module: HgvMetaIdentifierHelper::HgvDate</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>app/helpers/hgv_meta_identifier_helper.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-centuryOptions">::centuryOptions</a>
    
    <li><a href="#method-c-certaintyOptions">::certaintyOptions</a>
    
    <li><a href="#method-c-dayFromIso">::dayFromIso</a>
    
    <li><a href="#method-c-epidocToHgv">::epidocToHgv</a>
    
    <li><a href="#method-c-extractFromIso">::extractFromIso</a>
    
    <li><a href="#method-c-getCentury">::getCentury</a>
    
    <li><a href="#method-c-getCenturyQualifier">::getCenturyQualifier</a>
    
    <li><a href="#method-c-getCertaintyItem">::getCertaintyItem</a>
    
    <li><a href="#method-c-getDayIso">::getDayIso</a>
    
    <li><a href="#method-c-getEmptyEpidocItem">::getEmptyEpidocItem</a>
    
    <li><a href="#method-c-getEmptyHgvItem">::getEmptyHgvItem</a>
    
    <li><a href="#method-c-getMonthIso">::getMonthIso</a>
    
    <li><a href="#method-c-getMonthQualifier">::getMonthQualifier</a>
    
    <li><a href="#method-c-getOffsetItem">::getOffsetItem</a>
    
    <li><a href="#method-c-getPrecision">::getPrecision</a>
    
    <li><a href="#method-c-getPrecisionItem">::getPrecisionItem</a>
    
    <li><a href="#method-c-getYearIso">::getYearIso</a>
    
    <li><a href="#method-c-getYearQualifier">::getYearQualifier</a>
    
    <li><a href="#method-c-hgvToEpidoc">::hgvToEpidoc</a>
    
    <li><a href="#method-c-monthFromIso">::monthFromIso</a>
    
    <li><a href="#method-c-monthOptions">::monthOptions</a>
    
    <li><a href="#method-c-offsetOptions">::offsetOptions</a>
    
    <li><a href="#method-c-precisionOptions">::precisionOptions</a>
    
    <li><a href="#method-c-yearFromIso">::yearFromIso</a>
    
    <li><a href="#method-c-yearOptions">::yearOptions</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../doc/README_FOR_APP.html">README_FOR_APP</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../HgvMetaIdentifierHelper.html">HgvMetaIdentifierHelper</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvDate.html">HgvMetaIdentifierHelper::HgvDate</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvFormat.html">HgvMetaIdentifierHelper::HgvFormat</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvFuzzy.html">HgvMetaIdentifierHelper::HgvFuzzy</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvGeo.html">HgvMetaIdentifierHelper::HgvGeo</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvGeo/GeoSpot.html">HgvMetaIdentifierHelper::HgvGeo::GeoSpot</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvGeo/Place.html">HgvMetaIdentifierHelper::HgvGeo::Place</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvGeo/Provenance.html">HgvMetaIdentifierHelper::HgvGeo::Provenance</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvMentionedDate.html">HgvMetaIdentifierHelper::HgvMentionedDate</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvProvenance.html">HgvMetaIdentifierHelper::HgvProvenance</a>
  
    <li><a href="../HgvMetaIdentifierHelper/HgvPublication.html">HgvMetaIdentifierHelper::HgvPublication</a>
  
    <li><a href="../BiblioIdentifier.html">BiblioIdentifier</a>
  
    <li><a href="../BiblioIdentifier/Container.html">BiblioIdentifier::Container</a>
  
    <li><a href="../BiblioIdentifier/Note.html">BiblioIdentifier::Note</a>
  
    <li><a href="../BiblioIdentifier/PublicationPerson.html">BiblioIdentifier::PublicationPerson</a>
  
    <li><a href="../BiblioIdentifier/Publisher.html">BiblioIdentifier::Publisher</a>
  
    <li><a href="../BiblioIdentifier/RelatedArticle.html">BiblioIdentifier::RelatedArticle</a>
  
    <li><a href="../BiblioIdentifier/RelatedItem.html">BiblioIdentifier::RelatedItem</a>
  
    <li><a href="../BiblioIdentifier/Reviewee.html">BiblioIdentifier::Reviewee</a>
  
    <li><a href="../BiblioIdentifier/ShortTitle.html">BiblioIdentifier::ShortTitle</a>
  
    <li><a href="../JRubyXML.html">JRubyXML</a>
  
    <li><a href="../JRubyXML/EpiDocP4Validator.html">JRubyXML::EpiDocP4Validator</a>
  
    <li><a href="../JRubyXML/EpiDocP5Validator.html">JRubyXML::EpiDocP5Validator</a>
  
    <li><a href="../JRubyXML/JARVValidator.html">JRubyXML::JARVValidator</a>
  
    <li><a href="../JRubyXML/NamespaceContext.html">JRubyXML::NamespaceContext</a>
  
    <li><a href="../JRubyXML/ParseError.html">JRubyXML::ParseError</a>
  
    <li><a href="../JRubyXML/ParseErrorHandler.html">JRubyXML::ParseErrorHandler</a>
  
    <li><a href="../JRubyXML/RDFValidator.html">JRubyXML::RDFValidator</a>
  
    <li><a href="../JRubyXML/TransformErrorListener.html">JRubyXML::TransformErrorListener</a>
  
    <li><a href="../REXML.html">REXML</a>
  
    <li><a href="../REXML/Document.html">REXML::Document</a>
  
    <li><a href="../REXML/Element.html">REXML::Element</a>
  
    <li><a href="../REXML/XPath.html">REXML::XPath</a>
  
    <li><a href="../NumbersRDF.html">NumbersRDF</a>
  
    <li><a href="../NumbersRDF/NumbersHelper.html">NumbersRDF::NumbersHelper</a>
  
    <li><a href="../NumbersRDF/Timeout.html">NumbersRDF::Timeout</a>
  
    <li><a href="../Rpx.html">Rpx</a>
  
    <li><a href="../Rpx/RpxException.html">Rpx::RpxException</a>
  
    <li><a href="../Rpx/RpxHelper.html">Rpx::RpxHelper</a>
  
    <li><a href="../Comment.html">Comment</a>
  
    <li><a href="../Comment/CombineComment.html">Comment::CombineComment</a>
  
    <li><a href="../Doco.html">Doco</a>
  
    <li><a href="../Doco/DocoNode.html">Doco::DocoNode</a>
  
    <li><a href="../Grit.html">Grit</a>
  
    <li><a href="../Grit/Commit.html">Grit::Commit</a>
  
    <li><a href="../HGVMetaIdentifier.html">HGVMetaIdentifier</a>
  
    <li><a href="../HGVMetaIdentifier/HgvMetaConfiguration.html">HGVMetaIdentifier::HgvMetaConfiguration</a>
  
    <li><a href="../HGVTransGlossary.html">HGVTransGlossary</a>
  
    <li><a href="../HGVTransGlossary/Entry.html">HGVTransGlossary::Entry</a>
  
    <li><a href="../APISIdentifier.html">APISIdentifier</a>
  
    <li><a href="../AjaxProxyController.html">AjaxProxyController</a>
  
    <li><a href="../ApplicationController.html">ApplicationController</a>
  
    <li><a href="../ApplicationHelper.html">ApplicationHelper</a>
  
    <li><a href="../BiblioFormBuilder.html">BiblioFormBuilder</a>
  
    <li><a href="../BiblioIdentifiersController.html">BiblioIdentifiersController</a>
  
    <li><a href="../Board.html">Board</a>
  
    <li><a href="../BoardsController.html">BoardsController</a>
  
    <li><a href="../CollectionIdentifier.html">CollectionIdentifier</a>
  
    <li><a href="../CollectionIdentifiersController.html">CollectionIdentifiersController</a>
  
    <li><a href="../CommentsController.html">CommentsController</a>
  
    <li><a href="../CommunitiesController.html">CommunitiesController</a>
  
    <li><a href="../Community.html">Community</a>
  
    <li><a href="../CrossSiteController.html">CrossSiteController</a>
  
    <li><a href="../DDBIdentifier.html">DDBIdentifier</a>
  
    <li><a href="../DdbIdentifiersController.html">DdbIdentifiersController</a>
  
    <li><a href="../Decree.html">Decree</a>
  
    <li><a href="../DecreesController.html">DecreesController</a>
  
    <li><a href="../DocosController.html">DocosController</a>
  
    <li><a href="../DocovideosController.html">DocovideosController</a>
  
    <li><a href="../Emailer.html">Emailer</a>
  
    <li><a href="../EmailerMailer.html">EmailerMailer</a>
  
    <li><a href="../EmailersController.html">EmailersController</a>
  
    <li><a href="../Event.html">Event</a>
  
    <li><a href="../EventsController.html">EventsController</a>
  
    <li><a href="../GitConf.html">GitConf</a>
  
    <li><a href="../HGVIdentifier.html">HGVIdentifier</a>
  
    <li><a href="../HGVTransIdentifier.html">HGVTransIdentifier</a>
  
    <li><a href="../HelperController.html">HelperController</a>
  
    <li><a href="../HgvMetaIdentifiersController.html">HgvMetaIdentifiersController</a>
  
    <li><a href="../HgvTransGlossariesController.html">HgvTransGlossariesController</a>
  
    <li><a href="../HgvTransIdentifiersController.html">HgvTransIdentifiersController</a>
  
    <li><a href="../Identifier.html">Identifier</a>
  
    <li><a href="../IdentifiersController.html">IdentifiersController</a>
  
    <li><a href="../Integer.html">Integer</a>
  
    <li><a href="../Leiden.html">Leiden</a>
  
    <li><a href="../LeidenController.html">LeidenController</a>
  
    <li><a href="../LinkingInfo.html">LinkingInfo</a>
  
    <li><a href="../MaintenanceMode.html">MaintenanceMode</a>
  
    <li><a href="../Object.html">Object</a>
  
    <li><a href="../PrettySsime.html">PrettySsime</a>
  
    <li><a href="../Publication.html">Publication</a>
  
    <li><a href="../PublicationsController.html">PublicationsController</a>
  
    <li><a href="../Rails.html">Rails</a>
  
    <li><a href="../RepositoriesController.html">RepositoriesController</a>
  
    <li><a href="../Repository.html">Repository</a>
  
    <li><a href="../RpxController.html">RpxController</a>
  
    <li><a href="../TranslationHelperController.html">TranslationHelperController</a>
  
    <li><a href="../TranslationLeiden.html">TranslationLeiden</a>
  
    <li><a href="../TranslationLeidenController.html">TranslationLeidenController</a>
  
    <li><a href="../User.html">User</a>
  
    <li><a href="../UserController.html">UserController</a>
  
    <li><a href="../UserIdentifier.html">UserIdentifier</a>
  
    <li><a href="../Vote.html">Vote</a>
  
    <li><a href="../VotesController.html">VotesController</a>
  
    <li><a href="../WelcomeController.html">WelcomeController</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module HgvMetaIdentifierHelper::HgvDate</h1>

  <div id="description" class="description">
    
<p>Module for HGV date transformations and option values</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-centuryOptions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">centuryOptions</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Assembles all valid century qualifiers for HGV date
(<code>beginning</code>, <code>middle</code>, <code>end</code>, etc.)</p>
<ul><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Array</code> of +Array+s that can be used with rails’
<code>options_for_select</code> method</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="centuryOptions-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 736</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">centuryOptions</span>
  [[<span class="ruby-string">''</span>, <span class="ruby-string">''</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beginning'</span>), <span class="ruby-value">:beginning</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beginningCirca'</span>), <span class="ruby-value">:beginningCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beginningToMiddle'</span>), <span class="ruby-value">:beginningToMiddle</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beginningToMiddleCirca'</span>), <span class="ruby-value">:beginningToMiddleCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.firstHalf'</span>), <span class="ruby-value">:firstHalf</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.firstHalfCirca'</span>), <span class="ruby-value">:firstHalfCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.firstHalfToMiddle'</span>), <span class="ruby-value">:firstHalfToMiddle</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.firstHalfToMiddleCirca'</span>), <span class="ruby-value">:firstHalfToMiddleCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middle'</span>), <span class="ruby-value">:middle</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleCirca'</span>), <span class="ruby-value">:middleCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleToSecondHalf'</span>), <span class="ruby-value">:middleToSecondHalf</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleToSecondHalfCirca'</span>), <span class="ruby-value">:middleToSecondHalfCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.secondHalf'</span>), <span class="ruby-value">:secondHalf</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.secondHalfCirca'</span>), <span class="ruby-value">:secondHalfCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleToEnd'</span>), <span class="ruby-value">:middleToEnd</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleToEndCirca'</span>), <span class="ruby-value">:middleToEndCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.end'</span>), <span class="ruby-value">:end</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.endCirca'</span>), <span class="ruby-value">:endCirca</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- centuryOptions-source -->
          
        </div>

        

        
      </div><!-- centuryOptions-method -->

    
      <div id="method-c-certaintyOptions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">certaintyOptions</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Assembles all valid certainty options for HGV date (<code>low</code>,
<code>day</code>, <code>month</code>, <code>year</code>, etc.)</p>
<ul><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Array</code> of +Array+s that can be used with rails’
<code>options_for_select</code> method</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="certaintyOptions-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 772</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">certaintyOptions</span>
  [[<span class="ruby-string">''</span>, <span class="ruby-string">''</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.certaintyLow'</span>), <span class="ruby-value">:low</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.dayUncertain'</span>), <span class="ruby-value">:day</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.monthUncertain'</span>), <span class="ruby-value">:month</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.yearUncertain'</span>), <span class="ruby-value">:year</span>],
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.dayAndMonthUncertain'</span>), <span class="ruby-value">:day_month</span>],
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.monthAndYearUncertain'</span>), <span class="ruby-value">:month_year</span>],
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.dayAndYearUncertain'</span>), <span class="ruby-value">:day_year</span>],
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.dayMonthAndYearUncertain'</span>), <span class="ruby-value">:day_month_year</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- certaintyOptions-source -->
          
        </div>

        

        
      </div><!-- certaintyOptions-method -->

    
      <div id="method-c-dayFromIso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dayFromIso</span><span
            class="method-args">(iso)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Facade for <a
href="HgvDate.html#method-c-extractFromIso">::extractFromIso</a></p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>iso</code> ISO formatted date <code>String</code></p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Integer</code> day part of the ISO string</p>
</li></ul>
</li></ul>

<p>e.g. <a
href="HgvDate.html#method-c-dayFromIso">::dayFromIso</a>(‘1884-08-28’)
=&gt; 28</p>
          

          
          <div class="method-source-code" id="dayFromIso-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1104</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">dayFromIso</span> <span class="ruby-identifier">iso</span>
  <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">extractFromIso</span> <span class="ruby-identifier">iso</span>, <span class="ruby-regexp">/\A-?\d\d\d\d-\d\d-(\d\d)\Z/</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- dayFromIso-source -->
          
        </div>

        

        
      </div><!-- dayFromIso-method -->

    
      <div id="method-c-epidocToHgv" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">epidocToHgv</span><span
            class="method-args">(date_item)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Transforms EpiDoc structure provided by <code>HgvIdentifier</code> class
(nested values, attributes, children) into a simple <code>Hash</code>
structure (flat map of key as and values)</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>date_item</code> → date information</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Hash</code> of date information</p>
</li></ul>
</li></ul>

<p>for examples see unit test for HGV date operations (test/uni/date_test.rb)</p>
          

          
          <div class="method-source-code" id="epidocToHgv-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1165</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">epidocToHgv</span> <span class="ruby-identifier">date_item</span>      
  <span class="ruby-identifier">t</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getEmptyHgvItem</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> <span class="ruby-comment"># simple case: no date</span>
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:empty</span>] = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">t</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:value</span>] <span class="ruby-operator">==</span> <span class="ruby-string">'unbekannt'</span> <span class="ruby-comment"># simple case: date is specified as unknown</span>
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:unknown</span>] = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">t</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">begin</span> <span class="ruby-comment"># complex case: process date information</span>
    
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>]

      <span class="ruby-comment"># date1</span>
      <span class="ruby-identifier">iso</span> = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:when</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:when</span>] <span class="ruby-operator">:</span> (<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notBefore</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notBefore</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notAfter</span>])
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">iso</span>
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] = <span class="ruby-identifier">yearFromIso</span> <span class="ruby-identifier">iso</span>
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] = <span class="ruby-identifier">monthFromIso</span> <span class="ruby-identifier">iso</span>
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:d</span>] = <span class="ruby-identifier">dayFromIso</span> <span class="ruby-identifier">iso</span>

        <span class="ruby-comment"># date2</span>
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] = <span class="ruby-identifier">yearFromIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notAfter</span>]
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] = <span class="ruby-identifier">monthFromIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notAfter</span>]
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>] = <span class="ruby-identifier">dayFromIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notAfter</span>]

        <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>]
          <span class="ruby-comment"># ca.</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:precision</span>] <span class="ruby-operator">==</span> <span class="ruby-string">'medium'</span>
            <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca2</span>] = <span class="ruby-keyword">true</span>
          <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>]
            <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">precision</span><span class="ruby-operator">|</span>
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:degree</span>] <span class="ruby-operator">&amp;&amp;</span> [<span class="ruby-string">'0.1'</span>, <span class="ruby-string">'0.5'</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:degree</span>])
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>]
                  <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-string">'notBefore'</span>)
                    <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca</span>] = <span class="ruby-keyword">true</span>
                  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-string">'notAfter'</span>)
                    <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca2</span>] = <span class="ruby-keyword">true</span>
                  <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">else</span>
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca2</span>] = <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">end</span>
              <span class="ruby-keyword">end</span>
            }
          <span class="ruby-keyword">end</span>

          <span class="ruby-comment"># qualifier</span>
          <span class="ruby-identifier">isVague</span> = <span class="ruby-identifier">isVague2</span> = <span class="ruby-keyword">false</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:precision</span>] <span class="ruby-operator">==</span> <span class="ruby-string">'low'</span>
            <span class="ruby-identifier">isVague</span> = <span class="ruby-identifier">isVague2</span> = <span class="ruby-keyword">true</span>
          <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>]
            <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">precision</span><span class="ruby-operator">|</span>
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>] <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:degree</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:degree</span>] <span class="ruby-operator">&amp;&amp;</span> [<span class="ruby-string">'0.1'</span>, <span class="ruby-string">'0.3'</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:degree</span>])))
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>]
                  <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-string">'notBefore'</span>)
                    <span class="ruby-identifier">isVague</span> = <span class="ruby-keyword">true</span>
                  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">precision</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-string">'notAfter'</span>)
                    <span class="ruby-identifier">isVague2</span> = <span class="ruby-keyword">true</span>
                  <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">else</span>
                  <span class="ruby-identifier">isVague</span> = <span class="ruby-identifier">isVague2</span> = <span class="ruby-keyword">true</span>
                <span class="ruby-keyword">end</span>
              <span class="ruby-keyword">end</span>
            }
          <span class="ruby-keyword">end</span>

          <span class="ruby-keyword">if</span> <span class="ruby-identifier">isVague</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">isVague2</span>
            
            <span class="ruby-comment"># century</span>
            <span class="ruby-keyword">if</span> <span class="ruby-identifier">isVague</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:t</span>]
             
              <span class="ruby-identifier">t</span>[<span class="ruby-value">:c</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCentury</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] <span class="ruby-comment"># century no. 1</span>

              <span class="ruby-keyword">if</span> <span class="ruby-identifier">isVague2</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:t2</span>]
                <span class="ruby-identifier">t</span>[<span class="ruby-value">:c2</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCentury</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-comment"># century no. 2</span>
              <span class="ruby-keyword">end</span>

              <span class="ruby-identifier">cx</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCenturyQualifier</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>], <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>]  <span class="ruby-comment"># century qualifier (beginning, middle, end)</span>
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">cx</span>.<span class="ruby-identifier">instance_of?</span> <span class="ruby-constant">Array</span>
                <span class="ruby-identifier">t</span>[<span class="ruby-value">:cx</span>], <span class="ruby-identifier">t</span>[<span class="ruby-value">:cx2</span>] = <span class="ruby-identifier">cx</span>
              <span class="ruby-keyword">else</span>
                <span class="ruby-identifier">t</span>[<span class="ruby-value">:cx</span>] = <span class="ruby-identifier">cx</span>
              <span class="ruby-keyword">end</span>

              <span class="ruby-keyword">if</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:c</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:c2</span>]
                <span class="ruby-identifier">t</span>[<span class="ruby-value">:c2</span>] = <span class="ruby-keyword">nil</span> <span class="ruby-comment"># combine century no.1 and no.2</span>
              <span class="ruby-keyword">end</span>

              <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] = <span class="ruby-keyword">nil</span> <span class="ruby-comment"># kill years                  </span>
            <span class="ruby-keyword">end</span>
            
            <span class="ruby-comment"># year</span>
            <span class="ruby-keyword">if</span> <span class="ruby-identifier">isVague</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:t</span>]
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">isVague2</span> <span class="ruby-operator">&amp;&amp;</span>  <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:t2</span>]
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>]
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:yx</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearQualifier</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>], <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] <span class="ruby-comment"># combine date no. 1 and date no. 2</span>
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] = <span class="ruby-keyword">nil</span>
                <span class="ruby-keyword">else</span>
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:yx</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearQualifier</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>]
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:yx2</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearQualifier</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>]
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] = <span class="ruby-keyword">nil</span>
                <span class="ruby-keyword">end</span>
              <span class="ruby-keyword">else</span>
                <span class="ruby-identifier">t</span>[<span class="ruby-value">:yx</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearQualifier</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>]
                <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] = <span class="ruby-keyword">nil</span>
              <span class="ruby-keyword">end</span>
            <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">isVague2</span> <span class="ruby-operator">&amp;&amp;</span>  <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>]
              <span class="ruby-identifier">t</span>[<span class="ruby-value">:yx2</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearQualifier</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>]
              <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] = <span class="ruby-keyword">nil</span>
            <span class="ruby-keyword">end</span>
            
            <span class="ruby-comment">#month</span>
            <span class="ruby-keyword">if</span> <span class="ruby-identifier">isVague</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:t</span>]
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">isVague2</span> <span class="ruby-operator">&amp;&amp;</span>  <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:t2</span>]
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>]
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:mx</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthQualifier</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:d</span>], <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>] <span class="ruby-comment"># combine date no. 1 and date no. 2</span>
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:t</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:t2</span>] = <span class="ruby-keyword">nil</span>
                <span class="ruby-keyword">else</span>
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:mx</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthQualifier</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:d</span>]
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:mx2</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthQualifier</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>]
                  <span class="ruby-identifier">t</span>[<span class="ruby-value">:d</span>] = <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>] = <span class="ruby-keyword">nil</span>
                <span class="ruby-keyword">end</span>
              <span class="ruby-keyword">else</span>
                <span class="ruby-identifier">t</span>[<span class="ruby-value">:mx</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthQualifier</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:d</span>]
                <span class="ruby-identifier">t</span>[<span class="ruby-value">:d</span>] = <span class="ruby-keyword">nil</span>
              <span class="ruby-keyword">end</span>
            <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">isVague2</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>]
              <span class="ruby-identifier">t</span>[<span class="ruby-value">:mx2</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthQualifier</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>]
              <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>] = <span class="ruby-keyword">nil</span>
            <span class="ruby-keyword">end</span>

            <span class="ruby-comment"># ...(?)</span>
            <span class="ruby-identifier">t</span>.<span class="ruby-identifier">each_pair</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'x'</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'2'</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca2</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca</span>]
                  <span class="ruby-identifier">t</span>[<span class="ruby-identifier">k</span>] = (<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">'Circa'</span>).<span class="ruby-identifier">to_sym</span>
                <span class="ruby-keyword">end</span>
              <span class="ruby-keyword">end</span>
            }
          <span class="ruby-keyword">end</span> <span class="ruby-comment">#isVague</span>

          <span class="ruby-comment"># precision</span>
          <span class="ruby-identifier">t</span>[<span class="ruby-value">:precision</span>] = <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'2'</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> }.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">join</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'x'</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca</span>] <span class="ruby-operator">?</span> <span class="ruby-value">:ca</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
          <span class="ruby-identifier">t</span>[<span class="ruby-value">:precision2</span>] = (<span class="ruby-operator">!</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'2'</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> }.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">join</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'x'</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:ca2</span>] <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">t</span>[<span class="ruby-value">:c2</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>])) <span class="ruby-operator">?</span> <span class="ruby-value">:ca</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>

          <span class="ruby-comment"># offset</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:offset</span>]
            <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:offset</span>].<span class="ruby-identifier">each_index</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
               <span class="ruby-identifier">offset</span> = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:offset</span>][<span class="ruby-identifier">i</span>][<span class="ruby-value">:attributes</span>][<span class="ruby-value">:type</span>]
               <span class="ruby-identifier">position</span> = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:offset</span>][<span class="ruby-identifier">i</span>][<span class="ruby-value">:attributes</span>][<span class="ruby-value">:position</span>]
               <span class="ruby-identifier">attribute</span> = (<span class="ruby-string">'offset'</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">position</span> <span class="ruby-operator">==</span> <span class="ruby-string">'2'</span> <span class="ruby-operator">?</span> <span class="ruby-string">'2'</span> <span class="ruby-operator">:</span> <span class="ruby-string">''</span>)).<span class="ruby-identifier">to_sym</span>
               
               <span class="ruby-identifier">t</span>[<span class="ruby-identifier">attribute</span>] = <span class="ruby-identifier">offset</span>.<span class="ruby-identifier">to_sym</span>
               
               <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>]
                 <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">certainty</span><span class="ruby-operator">|</span>
                   <span class="ruby-keyword">if</span> <span class="ruby-identifier">certainty</span>[<span class="ruby-value">:attributes</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">certainty</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">certainty</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;../offset[@type='&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">offset</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;']&quot;</span>
                     <span class="ruby-identifier">t</span>[<span class="ruby-identifier">attribute</span>] = (<span class="ruby-identifier">t</span>[<span class="ruby-identifier">attribute</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">'Uncertain'</span>).<span class="ruby-identifier">to_sym</span>
                   <span class="ruby-keyword">end</span>
                 }
               <span class="ruby-keyword">end</span>
            }
          <span class="ruby-keyword">end</span>

          <span class="ruby-comment"># certainties</span>

          <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:certainty</span>]
            <span class="ruby-identifier">t</span>[<span class="ruby-value">:certainty</span>] = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:certainty</span>].<span class="ruby-identifier">to_sym</span>
          <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>]
            <span class="ruby-identifier">cert</span> = {<span class="ruby-value">:days</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>, <span class="ruby-value">:months</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>, <span class="ruby-value">:years</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>}
            <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">certainty</span><span class="ruby-operator">|</span>
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">certainty</span>[<span class="ruby-value">:attributes</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">certainty</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>]
                <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
                  <span class="ruby-keyword">if</span> <span class="ruby-identifier">certainty</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:match</span>].<span class="ruby-identifier">include?</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>]
                    <span class="ruby-identifier">cert</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
                  <span class="ruby-keyword">end</span>
                }
              <span class="ruby-keyword">end</span>
            }
            <span class="ruby-keyword">if</span> <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">join</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
              <span class="ruby-identifier">t</span>[<span class="ruby-value">:certainty</span>] = <span class="ruby-identifier">cert</span>.<span class="ruby-identifier">delete_if</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>}.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>] }.<span class="ruby-identifier">join</span>(<span class="ruby-string">'_'</span>).<span class="ruby-identifier">to_sym</span> <span class="ruby-comment"># CL support for plurals goes here</span>
            <span class="ruby-keyword">end</span>
          <span class="ruby-keyword">end</span>
          
          <span class="ruby-comment"># kill doublets and left overs</span>

          <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] = (<span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y</span>] <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>])
          <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] = (<span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m</span>] <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>])
          <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>] = (<span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:d</span>] <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>])
          <span class="ruby-identifier">t</span>[<span class="ruby-value">:precision2</span>] = (<span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:d2</span>]  <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:m2</span>]  <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:y2</span>]  <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t</span>[<span class="ruby-value">:c2</span>]  <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">t</span>[<span class="ruby-value">:precision2</span>])

        <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  
  <span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:error</span>] =  <span class="ruby-identifier">e</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">': '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span> <span class="ruby-operator">+</span> <span class="ruby-string">' ('</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-operator">+</span> <span class="ruby-string">')'</span> <span class="ruby-comment"># $!, $ERROR_INFO</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-identifier">t</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- epidocToHgv-source -->
          
        </div>

        

        
      </div><!-- epidocToHgv-method -->

    
      <div id="method-c-extractFromIso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">extractFromIso</span><span
            class="method-args">(iso, regex)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Finds the corresponding month qualifier of a given day range</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>iso</code> ISO formatted date <code>String</code></p>
</li><li>
<p><code>regex</code> regular expression</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Integer</code> extract of ISO data, first match of regular expression
or nil if no ISO formatted date is given or if no match can be made</p>
</li></ul>
</li></ul>

<p>e.g. <a
href="HgvDate.html#method-c-extractFromIso">::extractFromIso</a>(‘1884-08-28’,
/A(-?dddd)/) =&gt; 1884</p>
          

          
          <div class="method-source-code" id="extractFromIso-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1070</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">extractFromIso</span> <span class="ruby-identifier">iso</span>, <span class="ruby-identifier">regex</span> 
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">iso</span>
    <span class="ruby-identifier">iso</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">regex</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">iso</span>[<span class="ruby-identifier">regex</span>, <span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>  <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- extractFromIso-source -->
          
        </div>

        

        
      </div><!-- extractFromIso-method -->

    
      <div id="method-c-getCentury" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getCentury</span><span
            class="method-args">(year)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Finds the century of a given year</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>year</code> <code>Integer</code> value, e.g. -1234</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Integer</code>, e.g. <code>-13</code></p>
</li></ul>
</li></ul>

<p>e.g. <a href="HgvDate.html#method-c-getCentury">::getCentury</a> =&gt;
“-13”</p>
          

          
          <div class="method-source-code" id="getCentury-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 907</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCentury</span> <span class="ruby-identifier">year</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">year</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    (<span class="ruby-identifier">year</span>.<span class="ruby-identifier">abs</span> <span class="ruby-operator">/</span> <span class="ruby-value">100</span> <span class="ruby-operator">+</span> ((<span class="ruby-identifier">year</span>.<span class="ruby-identifier">abs</span> <span class="ruby-operator">%</span> <span class="ruby-value">100</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>)) * (<span class="ruby-identifier">year</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-value">-1</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- getCentury-source -->
          
        </div>

        

        
      </div><!-- getCentury-method -->

    
      <div id="method-c-getCenturyQualifier" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getCenturyQualifier</span><span
            class="method-args">(year, year2)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Finds the corresponding century qualifier of a given year range</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>year</code> <code>Integer</code> value of first year</p>
</li><li>
<p><code>year2</code> <code>Integer</code> value of second year</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Symbol</code>, e.g. <code>:middle</code></p>
</li></ul>
</li></ul>

<p>e.g. <a
href="HgvDate.html#method-c-getCenturyQualifier">::getCenturyQualifier</a>(126,
175) =&gt; :middle</p>
          

          
          <div class="method-source-code" id="getCenturyQualifier-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 922</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCenturyQualifier</span> <span class="ruby-identifier">year</span>, <span class="ruby-identifier">year2</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">year</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">year2</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">century</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCentury</span> <span class="ruby-identifier">year</span>
  <span class="ruby-identifier">century2</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCentury</span> <span class="ruby-identifier">year2</span>
  <span class="ruby-identifier">tens</span> = <span class="ruby-identifier">year</span>.<span class="ruby-identifier">abs</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-value">2</span>, <span class="ruby-string">'0'</span>)[<span class="ruby-value">-2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_i</span> * (<span class="ruby-identifier">year</span>.<span class="ruby-identifier">abs</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">year</span>)
  <span class="ruby-identifier">tens2</span> = <span class="ruby-identifier">year2</span>.<span class="ruby-identifier">abs</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-value">2</span>, <span class="ruby-string">'0'</span>)[<span class="ruby-value">-2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">to_i</span> * (<span class="ruby-identifier">year2</span>.<span class="ruby-identifier">abs</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">year2</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">century</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">century2</span>
    <span class="ruby-keyword">return</span> {
      [<span class="ruby-value">1</span>, <span class="ruby-value">25</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
      [<span class="ruby-value">26</span>, <span class="ruby-value">50</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:firstHalfToMiddle</span>,
      [<span class="ruby-value">51</span>, <span class="ruby-value">75</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middleToSecondHalf</span>,
      [<span class="ruby-value">76</span>, <span class="ruby-value">0</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span>,
      [<span class="ruby-value">1</span>, <span class="ruby-value">50</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:firstHalf</span>,
      [<span class="ruby-value">26</span>, <span class="ruby-value">75</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
      [<span class="ruby-value">51</span>, <span class="ruby-value">0</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:secondHalf</span>,
      [<span class="ruby-value">1</span>, <span class="ruby-value">75</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginningToMiddle</span>,
      [<span class="ruby-value">26</span>, <span class="ruby-value">0</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middleToEnd</span>,

      [<span class="ruby-value">0</span>, <span class="ruby-value">-76</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
      [<span class="ruby-value">-75</span>, <span class="ruby-value">-51</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:firstHalfToMiddle</span>,
      [<span class="ruby-value">-50</span>, <span class="ruby-value">-26</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middleToSecondHalf</span>,
      [<span class="ruby-value">-25</span>, <span class="ruby-value">-1</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span>,
      [<span class="ruby-value">0</span>, <span class="ruby-value">-51</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:firstHalf</span>,
      [<span class="ruby-value">-75</span>, <span class="ruby-value">-26</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
      [<span class="ruby-value">-50</span>, <span class="ruby-value">-1</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:secondHalf</span>,
      [<span class="ruby-value">0</span>, <span class="ruby-value">-26</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginningToMiddle</span>,
      [<span class="ruby-value">-75</span>, <span class="ruby-value">-1</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middleToEnd</span>
    }[[<span class="ruby-identifier">tens</span>, <span class="ruby-identifier">tens2</span>]]
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> [
      {
        <span class="ruby-comment">#1 =&gt; :beginning,</span>
        <span class="ruby-value">26</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
        <span class="ruby-value">51</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:secondHalf</span>,
        <span class="ruby-value">76</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span>,
        
        <span class="ruby-comment">#0 =&gt; :beginning,</span>
        <span class="ruby-value">-75</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
        <span class="ruby-value">-50</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:secondHalf</span>,
        <span class="ruby-value">-25</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span>
      }[<span class="ruby-identifier">tens</span>],
      {
        <span class="ruby-value">25</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
        <span class="ruby-value">50</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:fisrtHalf</span>,
        <span class="ruby-value">75</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
        <span class="ruby-comment">#0 =&gt; :end,</span>
        
        <span class="ruby-value">-76</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
        <span class="ruby-value">-51</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:firstHalf</span>,
        <span class="ruby-value">-26</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
        <span class="ruby-comment">#-1 =&gt; :end</span>
      }[<span class="ruby-identifier">tens2</span>]
    ]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- getCenturyQualifier-source -->
          
        </div>

        

        
      </div><!-- getCenturyQualifier-method -->

    
      <div id="method-c-getCertaintyItem" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getCertaintyItem</span><span
            class="method-args">(match)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Generate HGV EpiDoc like structure for certainty information (see
config/hgv.yml)</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>match</code> → qualifier for certainty range</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p>nested <code>Hash</code> set</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="getCertaintyItem-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1393</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCertaintyItem</span> <span class="ruby-identifier">match</span>
  {
    <span class="ruby-value">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:children</span> =<span class="ruby-operator">&gt;</span> {},
    <span class="ruby-value">:attributes</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:match</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">match</span>
    }
  }   
<span class="ruby-keyword">end</span></pre>
          </div><!-- getCertaintyItem-source -->
          
        </div>

        

        
      </div><!-- getCertaintyItem-method -->

    
      <div id="method-c-getDayIso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getDayIso</span><span
            class="method-args">(day, month, monthQualifier, chron)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Get ISO formatted month (DD)</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>day</code> <code>String</code> or <code>Integer</code>, that contains
a number, e.g. 31, may be <code>nil</code></p>
</li><li>
<p><code>month</code> <code>String</code> or <code>Integer</code>, that
contains a number, e.g. 5, may be <code>nil</code></p>
</li><li>
<p><code>monthQualifier</code> → qualifies which part of the year is of
interest, e.g. <code>:beginning</code>, may be <code>nil</code></p>
</li><li>
<p><code>chron</code> → <code>:chronMin</code> or <code>:chronMax</code></p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>String</code>, e.g. <code>31</code></p>
</li></ul>
</li></ul>

<p>e.g. <a href="HgvDate.html#method-c-getDayIso">::getDayIso</a>(nil, 7,
:end, :chronMax) =&gt; “31”</p>
          

          
          <div class="method-source-code" id="getDayIso-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 877</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getDayIso</span> <span class="ruby-identifier">day</span>, <span class="ruby-identifier">month</span>, <span class="ruby-identifier">monthQualifier</span>, <span class="ruby-identifier">chron</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">day</span>
    <span class="ruby-identifier">day</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-value">2</span>, <span class="ruby-string">'0'</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">m</span> = <span class="ruby-identifier">month</span>.<span class="ruby-identifier">to_i</span>
    <span class="ruby-identifier">day_max</span> = <span class="ruby-identifier">m</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">m</span> <span class="ruby-operator">!=</span> <span class="ruby-value">2</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">m</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">8</span> <span class="ruby-operator">?</span> ((<span class="ruby-identifier">m</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value">30</span> <span class="ruby-operator">:</span> <span class="ruby-value">31</span>) <span class="ruby-operator">:</span> ((<span class="ruby-identifier">m</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value">31</span> <span class="ruby-operator">:</span> <span class="ruby-value">30</span>) ) <span class="ruby-operator">:</span> (<span class="ruby-identifier">y</span> <span class="ruby-operator">&amp;&amp;</span> ((<span class="ruby-identifier">y</span> <span class="ruby-operator">%</span> <span class="ruby-value">4</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>) <span class="ruby-operator">&amp;&amp;</span> (((<span class="ruby-identifier">y</span> <span class="ruby-operator">%</span> <span class="ruby-value">100</span>) <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>) <span class="ruby-operator">||</span> ((<span class="ruby-identifier">y</span> <span class="ruby-operator">%</span> <span class="ruby-value">400</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)) <span class="ruby-operator">?</span> <span class="ruby-value">29</span> <span class="ruby-operator">:</span> <span class="ruby-value">28</span>)) <span class="ruby-operator">:</span> <span class="ruby-value">31</span>

    {
      <span class="ruby-value">:chronMin</span> =<span class="ruby-operator">&gt;</span> {
        <span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">:beginning</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'01'</span>,
        <span class="ruby-value">:middle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'11'</span>,
        <span class="ruby-value">:end</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'21'</span>
      },
      <span class="ruby-value">:chronMax</span> =<span class="ruby-operator">&gt;</span> {
        <span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">:beginning</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'10'</span>,
        <span class="ruby-value">:middle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'20'</span>,
        <span class="ruby-value">:end</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">day_max</span>.<span class="ruby-identifier">to_s</span>
      }
    }[<span class="ruby-identifier">chron</span>][<span class="ruby-identifier">monthQualifier</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">monthQualifier</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">'Circa'</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- getDayIso-source -->
          
        </div>

        

        
      </div><!-- getDayIso-method -->

    
      <div id="method-c-getEmptyEpidocItem" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getEmptyEpidocItem</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Provides an empty HGV EpiDoc date item</p>
<ul><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p>nested <code>Hash</code> structure with all relevant date keys, i.e.
century, year, month, day, certainty, offset etc.</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="getEmptyEpidocItem-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1125</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getEmptyEpidocItem</span>
  {
    <span class="ruby-value">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:attributes</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
      <span class="ruby-value">:when</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
      <span class="ruby-value">:notBefore</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
      <span class="ruby-value">:notAfter</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
      <span class="ruby-value">:certainty</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
      <span class="ruby-value">:precision</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>
    },
    <span class="ruby-value">:children</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:offset</span> =<span class="ruby-operator">&gt;</span> [],
      <span class="ruby-value">:precision</span> =<span class="ruby-operator">&gt;</span> [],
      <span class="ruby-value">:certainty</span> =<span class="ruby-operator">&gt;</span> []
    }
  }
<span class="ruby-keyword">end</span></pre>
          </div><!-- getEmptyEpidocItem-source -->
          
        </div>

        

        
      </div><!-- getEmptyEpidocItem-method -->

    
      <div id="method-c-getEmptyHgvItem" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getEmptyHgvItem</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Provides an empty HGV date item</p>
<ul><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p>flat <code>Hash</code> structure with all relevant date keys, i.e. century,
year, month, day, certainty, offset etc.</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="getEmptyHgvItem-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1111</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getEmptyHgvItem</span>
  {
    <span class="ruby-value">:c</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:y</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:m</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:d</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:cx</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:yx</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:mx</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:offset</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:precision</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:ca</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
    <span class="ruby-value">:c2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:y2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:m2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:d2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:cx2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:yx2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:mx2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:offset2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:precision2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:ca2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
    <span class="ruby-value">:certainty</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:unknown</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:empty</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>
  }
<span class="ruby-keyword">end</span></pre>
          </div><!-- getEmptyHgvItem-source -->
          
        </div>

        

        
      </div><!-- getEmptyHgvItem-method -->

    
      <div id="method-c-getMonthIso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getMonthIso</span><span
            class="method-args">(month, yearQualifier, chron)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Get ISO formatted month (MM)</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>month</code> <code>String</code>, that contains a number, e.g. 5, may
be <code>nil</code></p>
</li><li>
<p><code>yearQualifier</code> → qualifies which part of the year is of
interest, e.g. <code>:beginning</code>, may be <code>nil</code></p>
</li><li>
<p><code>chron</code> → <code>:chronMin</code> or <code>:chronMax</code></p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>String</code>, e.g. <code>05</code></p>
</li></ul>
</li></ul>

<p>e.g. <a href="HgvDate.html#method-c-getMonthIso">::getMonthIso</a>(nil,
:end, :chronMin) =&gt; “10”</p>
          

          
          <div class="method-source-code" id="getMonthIso-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 839</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthIso</span> <span class="ruby-identifier">month</span>, <span class="ruby-identifier">yearQualifier</span>, <span class="ruby-identifier">chron</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">month</span>
    <span class="ruby-identifier">month</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-value">2</span>, <span class="ruby-string">'0'</span>)
  <span class="ruby-keyword">else</span>
    {
      <span class="ruby-value">:chronMin</span> =<span class="ruby-operator">&gt;</span> {
        <span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">:beginning</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'01'</span>,
        <span class="ruby-value">:firstHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'01'</span>,
        <span class="ruby-value">:firstHalfToMiddle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'04'</span>,
        <span class="ruby-value">:middle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'04'</span>,
        <span class="ruby-value">:middleToSecondHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'07'</span>,
        <span class="ruby-value">:secondHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'07'</span>,
        <span class="ruby-value">:end</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'10'</span>
      },
      <span class="ruby-value">:chronMax</span> =<span class="ruby-operator">&gt;</span> {
        <span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
        <span class="ruby-value">:beginning</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'03'</span>,
        <span class="ruby-value">:firstHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'06'</span>,
        <span class="ruby-value">:firstHalfToMiddle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'06'</span>,
        <span class="ruby-value">:middle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'09'</span>,
        <span class="ruby-value">:middleToSecondHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'09'</span>,
        <span class="ruby-value">:secondHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'12'</span>,
        <span class="ruby-value">:end</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'12'</span>
      }
    }[<span class="ruby-identifier">chron</span>][<span class="ruby-identifier">yearQualifier</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">yearQualifier</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">'Circa'</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- getMonthIso-source -->
          
        </div>

        

        
      </div><!-- getMonthIso-method -->

    
      <div id="method-c-getMonthQualifier" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getMonthQualifier</span><span
            class="method-args">(day = nil, day2 = nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Finds the corresponding month qualifier of a given day range</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>day</code> <code>Integer</code> value of first day, may be
<code>nil</code></p>
</li><li>
<p><code>day2</code> <code>Integer</code> value of second day, may be
<code>nil</code></p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Symbol</code>, e.g. <code>:middle</code>, or <code>nil</code> if no
match is found</p>
</li></ul>
</li></ul>

<p>e.g. <a
href="HgvDate.html#method-c-getMonthQualifier">::getMonthQualifier</a>(11,
20) =&gt; :middle</p>
          

          
          <div class="method-source-code" id="getMonthQualifier-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1039</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthQualifier</span> <span class="ruby-identifier">day</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">day2</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">day</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">day2</span>
    <span class="ruby-keyword">return</span> {
      [<span class="ruby-value">1</span>, <span class="ruby-value">10</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
      [<span class="ruby-value">11</span>, <span class="ruby-value">20</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
      [<span class="ruby-value">21</span>, <span class="ruby-value">28</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span> <span class="ruby-comment"># CL</span>
    }[[<span class="ruby-identifier">day</span>, <span class="ruby-identifier">day2</span>]]
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">day</span>
    <span class="ruby-keyword">return</span> {
      <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
      <span class="ruby-value">11</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
      <span class="ruby-value">21</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span>
    }[<span class="ruby-identifier">day</span>]
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">day2</span>
    <span class="ruby-keyword">return</span> {
      <span class="ruby-value">10</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
      <span class="ruby-value">20</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
      <span class="ruby-value">28</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span> <span class="ruby-comment"># CL</span>
    }[<span class="ruby-identifier">day2</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- getMonthQualifier-source -->
          
        </div>

        

        
      </div><!-- getMonthQualifier-method -->

    
      <div id="method-c-getOffsetItem" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getOffsetItem</span><span
            class="method-args">(offset, position)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Generate HGV EpiDoc like structure for offset information (see
config/hgv.yml)</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>offset</code> → <code>:before</code>, <code>:after</code>,
<code>:beforeUncertain</code>, <code>:afterUncertain</code></p>
</li><li>
<p><code>position</code> → tells whether the offset belongs to the lower
part of the date range or to the upper</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p>nested <code>Hash</code> set</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="getOffsetItem-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1409</span>
<span class="ruby-keyword">def</span>  <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getOffsetItem</span> <span class="ruby-identifier">offset</span>, <span class="ruby-identifier">position</span>
  <span class="ruby-identifier">offset</span> = <span class="ruby-identifier">offset</span>.<span class="ruby-identifier">to_sym</span>
  {
    <span class="ruby-value">:value</span> =<span class="ruby-operator">&gt;</span> {<span class="ruby-value">:before</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'vor'</span>, <span class="ruby-value">:after</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'nach'</span>, <span class="ruby-value">:beforeUncertain</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'vor (?)'</span>, <span class="ruby-value">:afterUncertain</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'nach (?)'</span>}[<span class="ruby-identifier">offset</span>],
    <span class="ruby-value">:children</span> =<span class="ruby-operator">&gt;</span> {},
    <span class="ruby-value">:attributes</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">offset</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">'Uncertain'</span>, <span class="ruby-string">''</span>),
      <span class="ruby-value">:position</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">position</span>
    }
  }
<span class="ruby-keyword">end</span></pre>
          </div><!-- getOffsetItem-source -->
          
        </div>

        

        
      </div><!-- getOffsetItem-method -->

    
      <div id="method-c-getPrecision" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getPrecision</span><span
            class="method-args">(precision, cx, yx, mx)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Precision making process</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>precision</code> → circa</p>
</li><li>
<p><code>cx</code> → century qualifier</p>
</li><li>
<p><code>yx</code> → year qualifier</p>
</li><li>
<p><code>mx</code> → month qualifier</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Symbol</code> of combined precision :low, :medium, :lowlow</p>
</li></ul>
</li></ul>

<p><a href="HgvDate.html#method-c-getPrecision">::getPrecision</a>(‘ca’,
nil, nil, nil) =&gt; :medium</p>
          

          
          <div class="method-source-code" id="getPrecision-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1153</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecision</span> <span class="ruby-identifier">precision</span>, <span class="ruby-identifier">cx</span>, <span class="ruby-identifier">yx</span>, <span class="ruby-identifier">mx</span>
  <span class="ruby-identifier">ca</span> = <span class="ruby-identifier">precision</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">cx</span>  <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cx</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'Circa'</span>)) <span class="ruby-operator">||</span> (<span class="ruby-identifier">yx</span>  <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">yx</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'Circa'</span>)) <span class="ruby-operator">||</span> (<span class="ruby-identifier">mx</span>  <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">mx</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'Circa'</span>))
  <span class="ruby-identifier">vague</span> = <span class="ruby-identifier">cx</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">yx</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">mx</span>
  <span class="ruby-identifier">ca</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">vague</span> <span class="ruby-operator">?</span> <span class="ruby-value">:lowlow</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">ca</span> <span class="ruby-operator">?</span> <span class="ruby-value">:medium</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">vague</span> <span class="ruby-operator">?</span> <span class="ruby-value">:low</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- getPrecision-source -->
          
        </div>

        

        
      </div><!-- getPrecision-method -->

    
      <div id="method-c-getPrecisionItem" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getPrecisionItem</span><span
            class="method-args">(degree, match = nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Generate HGV EpiDoc like structure for precision information (see
config/hgv.yml)</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>degree</code> → degree of precision</p>
</li><li>
<p><code>match</code> → qualifier for precision range</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p>nested <code>Hash</code> set</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="getPrecisionItem-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1377</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span> <span class="ruby-identifier">degree</span>, <span class="ruby-identifier">match</span> = <span class="ruby-keyword">nil</span> 
  {
    <span class="ruby-value">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:children</span> =<span class="ruby-operator">&gt;</span> {},
    <span class="ruby-value">:attributes</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:match</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">match</span>,
      <span class="ruby-value">:degree</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">degree</span>
    }
  }   
<span class="ruby-keyword">end</span></pre>
          </div><!-- getPrecisionItem-source -->
          
        </div>

        

        
      </div><!-- getPrecisionItem-method -->

    
      <div id="method-c-getYearIso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getYearIso</span><span
            class="method-args">(century, centuryQualifier, chron)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Get ISO formatted year ([-]YYYY)</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>century</code> → signed integer, e.g. -5</p>
</li><li>
<p><code>centuryQualifier</code> → qualifies which part of the century is of
interest, e.g. <code>:beginning</code>, may be <code>nil</code></p>
</li><li>
<p><code>chron</code> → <code>:chronMin</code> or <code>:chronMax</code></p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>String</code>, e.g. <code>-0476</code></p>
</li></ul>
</li></ul>

<p>e.g. <a href="HgvDate.html#method-c-getYearIso">::getYearIso</a>(-5,
:beginning, :chronMax) =&gt; “-0476”</p>
          

          
          <div class="method-source-code" id="getYearIso-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 792</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearIso</span> <span class="ruby-identifier">century</span>, <span class="ruby-identifier">centuryQualifier</span>, <span class="ruby-identifier">chron</span>
  <span class="ruby-identifier">century</span> = <span class="ruby-identifier">century</span>.<span class="ruby-identifier">to_i</span>
  
  <span class="ruby-identifier">yearModifier</span> = {
    <span class="ruby-value">:chronMin</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
      <span class="ruby-value">:beginning</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
      <span class="ruby-value">:beginningToMiddle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
      <span class="ruby-value">:firstHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
      <span class="ruby-value">:firstHalfToMiddle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">25</span>,
      <span class="ruby-value">:middle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">25</span>,
      <span class="ruby-value">:middleToSecondHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">50</span>,
      <span class="ruby-value">:secondHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">50</span>,
      <span class="ruby-value">:middleToEnd</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">25</span>,
      <span class="ruby-value">:end</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">75</span>
    },
    <span class="ruby-value">:chronMax</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
      <span class="ruby-value">:beginning</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">-75</span>,
      <span class="ruby-value">:beginningToMiddle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">-50</span>,
      <span class="ruby-value">:firstHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">-50</span>,
      <span class="ruby-value">:firstHalfToMiddle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">-50</span>,
      <span class="ruby-value">:middle</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">-25</span>,
      <span class="ruby-value">:middleToSecondHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">-25</span>,
      <span class="ruby-value">:secondHalf</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
      <span class="ruby-value">:middleToEnd</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
      <span class="ruby-value">:end</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
    }
  }[<span class="ruby-identifier">chron</span>][<span class="ruby-identifier">centuryQualifier</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">centuryQualifier</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">'Circa'</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>]

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">chron</span> <span class="ruby-operator">==</span> <span class="ruby-value">:chronMax</span>
    <span class="ruby-identifier">year</span> = <span class="ruby-identifier">century</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">century</span> * <span class="ruby-value">100</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">yearModifier</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-value">4</span>, <span class="ruby-string">'0'</span>) <span class="ruby-operator">:</span> ((<span class="ruby-identifier">century</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>) * <span class="ruby-value">100</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">yearModifier</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">abs</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-value">4</span>, <span class="ruby-string">'0'</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">year</span> = <span class="ruby-identifier">century</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">century</span> * <span class="ruby-value">100</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">yearModifier</span>).<span class="ruby-identifier">abs</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-value">4</span>, <span class="ruby-string">'0'</span>) <span class="ruby-operator">:</span> ((<span class="ruby-identifier">century</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>) * <span class="ruby-value">100</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">yearModifier</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-value">4</span>, <span class="ruby-string">'0'</span>)
  <span class="ruby-keyword">end</span>

  (<span class="ruby-identifier">century</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-string">'-'</span> <span class="ruby-operator">:</span> <span class="ruby-string">''</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">year</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- getYearIso-source -->
          
        </div>

        

        
      </div><!-- getYearIso-method -->

    
      <div id="method-c-getYearQualifier" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">getYearQualifier</span><span
            class="method-args">(month = nil, month2 = nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Finds the corresponding year qualifier of a given month range</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>month</code> <code>Integer</code> value of first month, may be
<code>nil</code></p>
</li><li>
<p><code>month2</code> <code>Integer</code> value of second month, may be
<code>nil</code></p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Symbol</code>, e.g. <code>:middle</code>, or <code>nil</code> if no
match is found</p>
</li></ul>
</li></ul>

<p>e.g. <a
href="HgvDate.html#method-c-getYearQualifier">::getYearQualifier</a>(5, 8)
=&gt; :summer</p>
          

          
          <div class="method-source-code" id="getYearQualifier-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 989</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearQualifier</span> <span class="ruby-identifier">month</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">month2</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">month</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">month2</span>
    <span class="ruby-keyword">return</span> {
      [<span class="ruby-value">1</span>, <span class="ruby-value">2</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:lateWinter</span>,
      [<span class="ruby-value">2</span>, <span class="ruby-value">5</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:spring</span>,
      [<span class="ruby-value">5</span>, <span class="ruby-value">8</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:summer</span>,
      [<span class="ruby-value">8</span>, <span class="ruby-value">11</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:autumn</span>,
      [<span class="ruby-value">11</span>, <span class="ruby-value">12</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:earlyWinter</span>,
      [<span class="ruby-value">1</span>, <span class="ruby-value">6</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:firstHalf</span>,
      [<span class="ruby-value">4</span>, <span class="ruby-value">9</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
      [<span class="ruby-value">7</span>, <span class="ruby-value">12</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:secondHalf</span>,
      [<span class="ruby-value">1</span>, <span class="ruby-value">3</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
      [<span class="ruby-value">4</span>, <span class="ruby-value">6</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:fistHalfToMiddle</span>,
      [<span class="ruby-value">7</span>, <span class="ruby-value">9</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middleToFirstHalf</span>,
      [<span class="ruby-value">10</span>, <span class="ruby-value">12</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span>
    }[[<span class="ruby-identifier">month</span>, <span class="ruby-identifier">month2</span>]]
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">month</span>
    <span class="ruby-keyword">return</span> {
      <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
      <span class="ruby-value">2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:spring</span>,
      <span class="ruby-value">4</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
      <span class="ruby-value">5</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:summer</span>,
      <span class="ruby-value">7</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:secondHalf</span>,
      <span class="ruby-value">8</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:autumn</span>,
      <span class="ruby-value">10</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span>,
      <span class="ruby-value">11</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:earlyWinter</span>
    }[<span class="ruby-identifier">month</span>]
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">month2</span>
    <span class="ruby-keyword">return</span> {
      <span class="ruby-value">2</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:lateWinter</span>,
      <span class="ruby-value">3</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:beginning</span>,
      <span class="ruby-value">5</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:spring</span>,
      <span class="ruby-value">6</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:firstHalf</span>,
      <span class="ruby-value">8</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:summer</span>,
      <span class="ruby-value">9</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:middle</span>,
      <span class="ruby-value">11</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:autumn</span>,
      <span class="ruby-value">12</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:end</span>,
    }[<span class="ruby-identifier">month2</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- getYearQualifier-source -->
          
        </div>

        

        
      </div><!-- getYearQualifier-method -->

    
      <div id="method-c-hgvToEpidoc" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">hgvToEpidoc</span><span
            class="method-args">(date_item)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Transforms simple <code>Hash</code> structure (flat map of key as and
values) into EpiDoc structure that can be digested by
<code>HgvIdentifier</code> class (nested values, attributes, children)</p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>date_item</code> → date information</p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p>nested <code>Hash</code> of date information</p>
</li></ul>
</li></ul>

<p>for examples see unit test for HGV date operations (test/uni/date_test.rb)</p>
          

          
          <div class="method-source-code" id="hgvToEpidoc-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1427</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">hgvToEpidoc</span> <span class="ruby-identifier">date_item</span>
  <span class="ruby-identifier">t</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getEmptyEpidocItem</span>
    
  <span class="ruby-comment"># date it X, Y, Z</span>
  <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:id</span>] = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:id</span>]

  <span class="ruby-comment"># unknown</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:unknown</span>]
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:value</span>] = <span class="ruby-string">'unbekannt'</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">t</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># centuries</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:c</span>]
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notBefore</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:c</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx</span>], <span class="ruby-value">:chronMin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:c2</span>]
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notAfter</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:c2</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx2</span>], <span class="ruby-value">:chronMax</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notAfter</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getYearIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:c</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx</span>], <span class="ruby-value">:chronMax</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">ca</span> = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'Circa'</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">ca2</span> = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx2</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'Circa'</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ca</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ca2</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span> <span class="ruby-string">'0.1'</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ca</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span> <span class="ruby-string">'0.1'</span>, <span class="ruby-string">'../@notBefore'</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span> <span class="ruby-string">'0.3'</span>, <span class="ruby-string">'../@notAfter'</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ca2</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span> <span class="ruby-string">'0.3'</span>, <span class="ruby-string">'../@notBefore'</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span> <span class="ruby-string">'0.1'</span>, <span class="ruby-string">'../@notAfter'</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:precision</span>] = <span class="ruby-string">'low'</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">y</span> = {<span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">''</span>, <span class="ruby-value">0</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'-'</span>}[<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:y</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">/-/</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:y</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-string">'-'</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">rjust</span>(<span class="ruby-value">4</span>, <span class="ruby-string">'0'</span>)
    <span class="ruby-identifier">m</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:m</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:yx</span>], <span class="ruby-value">:chronMin</span>
    <span class="ruby-identifier">d</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getDayIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:d</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:m</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:mx</span>], <span class="ruby-value">:chronMin</span>
    
    <span class="ruby-identifier">date</span> = <span class="ruby-identifier">y</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">m</span> <span class="ruby-operator">?</span> <span class="ruby-string">'-'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">d</span> <span class="ruby-operator">?</span> <span class="ruby-string">'-'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">d</span> <span class="ruby-operator">:</span> <span class="ruby-string">''</span>) <span class="ruby-operator">:</span> <span class="ruby-string">''</span>)
    
    <span class="ruby-comment"># only one date</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">date_item</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">date_item</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">date_item</span>[<span class="ruby-value">:d2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">date_item</span>[<span class="ruby-value">:yx</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">date_item</span>[<span class="ruby-value">:mx</span>]
      <span class="ruby-identifier">attribute</span> = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset</span>] <span class="ruby-operator">?</span> (<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-string">'before'</span>) <span class="ruby-operator">?</span> <span class="ruby-value">:notAfter</span> <span class="ruby-operator">:</span> <span class="ruby-value">:notBefore</span>) <span class="ruby-operator">:</span> <span class="ruby-value">:when</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-identifier">attribute</span>] = <span class="ruby-identifier">date</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notBefore</span>] = <span class="ruby-identifier">date</span>
      
      <span class="ruby-identifier">y2</span> = <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">?</span> {<span class="ruby-keyword">nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">''</span>, <span class="ruby-value">0</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'-'</span>}[<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:y2</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">/-/</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:y2</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-string">'-'</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">rjust</span>(<span class="ruby-value">4</span>, <span class="ruby-string">'0'</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">y</span>
      <span class="ruby-identifier">m2</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getMonthIso</span>((<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:m2</span>] <span class="ruby-operator">:</span> (<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:d2</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:m</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)), (<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:yx2</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:yx2</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:yx</span>]), <span class="ruby-value">:chronMax</span>)
      <span class="ruby-identifier">d2</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getDayIso</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:d2</span>], (<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:m</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:m</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>), (<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:mx</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:mx</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:mx2</span>]), <span class="ruby-value">:chronMax</span>
      
      <span class="ruby-identifier">date2</span> = <span class="ruby-identifier">y2</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">m2</span> <span class="ruby-operator">?</span> <span class="ruby-string">'-'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m2</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">d2</span> <span class="ruby-operator">?</span> <span class="ruby-string">'-'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">d2</span> <span class="ruby-operator">:</span> <span class="ruby-string">''</span>) <span class="ruby-operator">:</span> <span class="ruby-string">''</span>)
      
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notAfter</span>] = <span class="ruby-identifier">date2</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># precision</span>
    <span class="ruby-identifier">precision</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecision</span>(<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:precision</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:yx</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:mx</span>])
    <span class="ruby-identifier">precision2</span> = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecision</span>(<span class="ruby-identifier">date_item</span>[<span class="ruby-value">:precision2</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:cx2</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:yx2</span>], <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:mx2</span>])

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision</span> <span class="ruby-operator">&amp;&amp;</span> ((<span class="ruby-identifier">precision</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">precision2</span>) <span class="ruby-operator">||</span> ([<span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:when</span>], <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notBefore</span>], <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:notAfter</span>]].<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>))
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision</span> <span class="ruby-operator">==</span> <span class="ruby-value">:lowlow</span>
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span> <span class="ruby-string">'0.1'</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:precision</span>] = <span class="ruby-identifier">precision</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">precision</span>
       <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span>(<span class="ruby-identifier">precision</span> <span class="ruby-operator">==</span> <span class="ruby-value">:low</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">precision</span> <span class="ruby-operator">==</span> <span class="ruby-value">:medium</span> <span class="ruby-operator">?</span> <span class="ruby-string">'0.5'</span> <span class="ruby-operator">:</span> <span class="ruby-string">'0.1'</span>), <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:when</span>] <span class="ruby-operator">?</span> <span class="ruby-string">'../@when'</span> <span class="ruby-operator">:</span> <span class="ruby-string">'../@notBefore'</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">precision2</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:precision</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getPrecisionItem</span>(<span class="ruby-identifier">precision2</span> <span class="ruby-operator">==</span> <span class="ruby-value">:low</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">precision2</span> <span class="ruby-operator">==</span> <span class="ruby-value">:medium</span> <span class="ruby-operator">?</span> <span class="ruby-string">'0.5'</span> <span class="ruby-operator">:</span> <span class="ruby-string">'0.1'</span>), <span class="ruby-string">'../@notAfter'</span>)
    <span class="ruby-keyword">end</span>

    
  <span class="ruby-keyword">end</span>
        
  <span class="ruby-comment"># offset</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset</span>]
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:offset</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:offset</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getOffsetItem</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset</span>], <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset2</span>]
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:offset</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:offset</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getOffsetItem</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset2</span>], <span class="ruby-value">2</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># offset certainty</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'Uncertain'</span>)
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCertaintyItem</span> <span class="ruby-string">&quot;../offset[@type='&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">'Uncertain'</span>, <span class="ruby-string">''</span>)<span class="ruby-operator">+</span><span class="ruby-string">&quot;']&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset2</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset2</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'Uncertain'</span>)
    <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCertaintyItem</span> <span class="ruby-string">&quot;../offset[@type='&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">date_item</span>[<span class="ruby-value">:offset2</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">'Uncertain'</span>, <span class="ruby-string">''</span>)<span class="ruby-operator">+</span><span class="ruby-string">&quot;']&quot;</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-comment"># certainty</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:certainty</span>] <span class="ruby-comment"># global uncertainty</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:certainty</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:low</span>
      <span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:certainty</span>] = <span class="ruby-string">'low'</span>
    <span class="ruby-keyword">else</span> <span class="ruby-comment"># uncertainty for day, month or year</span>
      <span class="ruby-identifier">date_item</span>[<span class="ruby-value">:certainty</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">'_'</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">dayMonthYear</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">match</span> = <span class="ruby-string">'../'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">dayMonthYear</span> <span class="ruby-operator">+</span> <span class="ruby-string">'-from-date(@'</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">t</span>[<span class="ruby-value">:attributes</span>][<span class="ruby-value">:when</span>] <span class="ruby-operator">?</span> <span class="ruby-string">'when'</span> <span class="ruby-operator">:</span> <span class="ruby-string">'notBefore'</span>) <span class="ruby-operator">+</span> <span class="ruby-string">')'</span> <span class="ruby-comment"># cl: support for plurals would go here </span>
        <span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>][<span class="ruby-identifier">t</span>[<span class="ruby-value">:children</span>][<span class="ruby-value">:certainty</span>].<span class="ruby-identifier">length</span>] = <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">getCertaintyItem</span> <span class="ruby-identifier">match</span>
      }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-comment"># hgv format</span>
  <span class="ruby-identifier">t</span>[<span class="ruby-value">:value</span>] = <span class="ruby-constant">HgvFormat</span>.<span class="ruby-identifier">formatDate</span> <span class="ruby-identifier">date_item</span>

  <span class="ruby-identifier">t</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- hgvToEpidoc-source -->
          
        </div>

        

        
      </div><!-- hgvToEpidoc-method -->

    
      <div id="method-c-monthFromIso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">monthFromIso</span><span
            class="method-args">(iso)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Facade for <a
href="HgvDate.html#method-c-extractFromIso">::extractFromIso</a></p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>iso</code> ISO formatted date <code>String</code></p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Integer</code> month part of the ISO string</p>
</li></ul>
</li></ul>

<p>e.g. <a
href="HgvDate.html#method-c-monthFromIso">::monthFromIso</a>(‘1884-08-28’)
=&gt; 8</p>
          

          
          <div class="method-source-code" id="monthFromIso-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1094</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">monthFromIso</span> <span class="ruby-identifier">iso</span>
  <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">extractFromIso</span> <span class="ruby-identifier">iso</span>, <span class="ruby-regexp">/\A-?\d\d\d\d-(\d\d)/</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- monthFromIso-source -->
          
        </div>

        

        
      </div><!-- monthFromIso-method -->

    
      <div id="method-c-monthOptions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">monthOptions</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Assembles all valid month qualifiers for HGV date (<code>beginning</code>,
<code>middle</code>, <code>end</code>, etc.)</p>
<ul><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Array</code> of +Array+s that can be used with rails’
<code>options_for_select</code> method</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="monthOptions-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 702</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">monthOptions</span>
  [[<span class="ruby-string">''</span>, <span class="ruby-string">''</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beginning'</span>), <span class="ruby-value">:beginning</span>],
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beginningCirca'</span>), <span class="ruby-value">:beginningCirca</span>],
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middle'</span>), <span class="ruby-value">:middle</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleCirca'</span>), <span class="ruby-value">:middleCirca</span>],
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.end'</span>), <span class="ruby-value">:end</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.endCirca'</span>), <span class="ruby-value">:endCirca</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- monthOptions-source -->
          
        </div>

        

        
      </div><!-- monthOptions-method -->

    
      <div id="method-c-offsetOptions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">offsetOptions</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Assembles all valid offset options for HGV date (<code>before</code>,
<code>after</code>, etc.)</p>
<ul><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Array</code> of +Array+s that can be used with rails’
<code>options_for_select</code> method</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="offsetOptions-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 761</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">offsetOptions</span>
  [[<span class="ruby-string">''</span>, <span class="ruby-string">''</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.before'</span>), <span class="ruby-value">:before</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.after'</span>), <span class="ruby-value">:after</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beforeUncertain'</span>), <span class="ruby-value">:beforeUncertain</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.afterUncertain'</span>), <span class="ruby-value">:afterUncertain</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- offsetOptions-source -->
          
        </div>

        

        
      </div><!-- offsetOptions-method -->

    
      <div id="method-c-precisionOptions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">precisionOptions</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Assembles all valid precision options for HGV date (<code>ca.</code>)</p>
<ul><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Array</code> of +Array+s that can be used with rails’
<code>options_for_select</code> method</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="precisionOptions-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 694</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">precisionOptions</span>
  [[<span class="ruby-string">''</span>, <span class="ruby-string">''</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.ca'</span>), <span class="ruby-value">:ca</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- precisionOptions-source -->
          
        </div>

        

        
      </div><!-- precisionOptions-method -->

    
      <div id="method-c-yearFromIso" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">yearFromIso</span><span
            class="method-args">(iso)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Facade for <a
href="HgvDate.html#method-c-extractFromIso">::extractFromIso</a></p>
<ul><li>
<p><strong>Args</strong>  :</p>
<ul><li>
<p><code>iso</code> ISO formatted date <code>String</code></p>
</li></ul>
</li><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Integer</code> year part of the ISO string</p>
</li></ul>
</li></ul>

<p>e.g. <a
href="HgvDate.html#method-c-yearFromIso">::yearFromIso</a>(‘1884-08-28’)
=&gt; 1884</p>
          

          
          <div class="method-source-code" id="yearFromIso-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 1084</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">yearFromIso</span> <span class="ruby-identifier">iso</span>
  <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">extractFromIso</span> <span class="ruby-identifier">iso</span>, <span class="ruby-regexp">/\A(-?\d\d\d\d)/</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- yearFromIso-source -->
          
        </div>

        

        
      </div><!-- yearFromIso-method -->

    
      <div id="method-c-yearOptions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">yearOptions</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Assembles all valid year qualifiers for HGV date (<code>beginning</code>,
<code>middle</code>, <code>end</code>, etc.)</p>
<ul><li>
<p><strong>Returns</strong> :</p>
<ul><li>
<p><code>Array</code> of +Array+s that can be used with rails’
<code>options_for_select</code> method</p>
</li></ul>
</li></ul>
          

          
          <div class="method-source-code" id="yearOptions-source">
            <pre><span class="ruby-comment"># File app/helpers/hgv_meta_identifier_helper.rb, line 715</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">HgvDate</span>.<span class="ruby-identifier">yearOptions</span>
  [[<span class="ruby-string">''</span>, <span class="ruby-string">''</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beginning'</span>), <span class="ruby-value">:beginning</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.beginningCirca'</span>), <span class="ruby-value">:beginningCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.firstHalf'</span>), <span class="ruby-value">:firstHalf</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.firstHalfCirca'</span>), <span class="ruby-value">:firstHalfCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.firstHalfToMiddle'</span>), <span class="ruby-value">:firstHalfToMiddle</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.firstHalfToMiddleCirca'</span>), <span class="ruby-value">:firstHalfToMiddleCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middle'</span>), <span class="ruby-value">:middle</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleCirca'</span>), <span class="ruby-value">:middleCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleToSecondHalf'</span>), <span class="ruby-value">:middleToSecondHalf</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.middleToSecondHalfCirca'</span>), <span class="ruby-value">:middleToSecondHalfCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.secondHalf'</span>), <span class="ruby-value">:secondHalf</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.secondHalfCirca'</span>), <span class="ruby-value">:secondHalfCirca</span>], 
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.end'</span>), <span class="ruby-value">:end</span>],
    [<span class="ruby-constant">I18n</span>.<span class="ruby-identifier">t</span>(<span class="ruby-string">'date.endCirca'</span>), <span class="ruby-value">:endCirca</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- yearOptions-source -->
          
        </div>

        

        
      </div><!-- yearOptions-method -->

    
    </section><!-- public-class-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.11.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

